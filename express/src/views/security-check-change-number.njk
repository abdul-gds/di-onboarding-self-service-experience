{% extends "layout.njk" %}
{% from "macros/back-link.njk" import backLink %}
{% from "macros/error-summary.njk" import errorSummary %}
{% from "govuk/components/input/macro.njk" import govukInput %}

{% set pageTitle = "Security check" %}
{% set backLink = backLink("/resend-text-code") %}

{% block mainContent %}
  {{ errorSummary ({
    errors: errorMessages,
    hrefs: {
      "create-email-otp": "#create-email-otp"
    }
  }) }}

  <h1 class="govuk-heading-l">We need to do a security check</h1>
  <p class="govuk-body">Before you can change your phone number, we need to do a security check to make sure itâ€™s you.</p>

  <div class="govuk-inset-text">
    We have sent an email to: <span class="govuk-!-font-weight-bold">{{ emailAddress }}</span>
  </div>

  <p class="govuk-body">The email contains a 6 digit security code.</p>
  <p class="govuk-body">The email might take a few minutes to arrive. If you do not get an email, check your spam folder.</p>
  <p class="govuk-body">The code will expire after 15 minutes.</p>

  <form class="form" action="/security-check-change-number" method="post">
    {{ govukInput({
      label: {
        text: "Enter the 6 digit security code"
      },
      name: "create-email-otp",
      id: "create-email-otp",
      classes: "govuk-input--width-5",
      type: "text",
      inputmode: "numeric",
      pattern: "[0-9]*",
      spellcheck: false,
      value: value.otp,
      errorMessage: {
        text: errorMessages.get('create-email-otp')
      } if errorMessages else false
    }) }}

    {{ govukButton({ text: "Resend security code", attributes: {id: "submit"} }) }}

    <p class="govuk-body"><a id="resend-code-page" class="govuk-link" href="/resend-email-code">Problems receiving an email?</a></p>
  </form>
{% endblock %}
